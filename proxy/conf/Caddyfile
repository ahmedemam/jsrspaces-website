{
    email admin@jsrspaces.com
}

# Main website - www.jsrspaces.com (primary domain)
www.jsrspaces.com {
    encode gzip
    
    # Serve static files from nginx container
    reverse_proxy website:80 {
        header_up Host {host}
        header_up X-Real-IP {remote}
        header_up X-Forwarded-For {remote}
        header_up X-Forwarded-Host {host}
        header_up X-Forwarded-Proto https
    }
}

# Non-www redirect to www (apex domain)
# Caddy will automatically get SSL certificate for this domain too
jsrspaces.com {
    # Redirect HTTP to HTTPS first, then to www
    redir https://www.jsrspaces.com{uri} permanent
}

# ERPNext - Enterprise Resource Planning
erp.jsrspaces.com {
    encode gzip
    reverse_proxy erp_frontend:8080 {
        header_up Host {host}
        header_up X-Real-IP {remote}
        header_up X-Forwarded-For {remote}
        header_up X-Forwarded-Host {host}
        header_up X-Forwarded-Proto https
        header_up X-Forwarded-Port 443
    }
}

# Cobot - Coworking Space Management
# Option 1: Proxy to Cobot SaaS (recommended)
# Requires DNS CNAME: cobot.jsrspaces.com -> domains.cobot.me
# Then configure custom domain in Cobot admin panel
cobot.jsrspaces.com {
    encode gzip
    reverse_proxy domains.cobot.me:443 {
        header_up Host domains.cobot.me
        header_up X-Real-IP {remote}
        header_up X-Forwarded-For {remote}
        header_up X-Forwarded-Host {host}
        header_up X-Forwarded-Proto https
        tls_server_name domains.cobot.me
    }
}

# Option 2: Self-hosted Cobot (when available)
# Uncomment and configure when self-hosted Docker image is ready
# cobot.jsrspaces.com {
#     encode gzip
#     reverse_proxy cobot:3000 {
#         header_up Host {host}
#         header_up X-Real-IP {remote}
#         header_up X-Forwarded-For {remote}
#         header_up X-Forwarded-Host {host}
#         header_up X-Forwarded-Proto https
#     }
# }

# Optional: admin panel or API subdomain
# admin.jsrspaces.com {
#     encode gzip
#     reverse_proxy admin:3000 {
#         header_up Host {host}
#         header_up X-Forwarded-Proto https
#     }
# }

